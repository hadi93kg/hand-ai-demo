<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>AI Hand Sphere Demo</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  margin:0;
  background:#020617;
  color:#e5e7eb;
  font-family:Arial;
  overflow:hidden;
}

#ui {
  position:absolute;
  top:30px;
  left:30px;
  z-index:10;
}

h1 { font-size:28px; }
p { opacity:.8 }

canvas {
  position:fixed;
  top:0;
  left:0;
}
</style>
</head>

<body>

<div id="ui">
  <h1>AI Hand Sphere</h1>
  <p>Move your hand in front of camera</p>
</div>

<video id="video" autoplay playsinline style="display:none"></video>
<canvas id="canvas"></canvas>

<script src="./vision_bundle.js"></script>

<script>
const video = document.getElementById("video");
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");

canvas.width = innerWidth;
canvas.height = innerHeight;

async function startCam(){
  const stream = await navigator.mediaDevices.getUserMedia({video:true});
  video.srcObject = stream;
}
startCam();

let handLandmarker;

async function loadAI(){
  const vision = await FilesetResolver.forVisionTasks(
    "https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@latest/wasm"
  );

  handLandmarker = await HandLandmarker.createFromOptions(vision,{
    baseOptions:{
      modelAssetPath:"./models/hand_landmarker.task"
    },
    numHands:1
  });
}
loadAI();

function drawSphere(points){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  const cx = canvas.width/2;
  const cy = canvas.height/2;

  for(let p of points){
    const x = cx + (p.x-.5)*500;
    const y = cy + (p.y-.5)*500;

    ctx.beginPath();
    ctx.fillStyle="#60a5fa";
    ctx.arc(x,y,6,0,Math.PI*2);
    ctx.fill();
  }
}

async function loop(){
  if(handLandmarker){
    const res = await handLandmarker.detectForVideo(video,performance.now());
    if(res.landmarks.length){
      drawSphere(res.landmarks[0]);
    }
  }
  requestAnimationFrame(loop);
}
loop();
</script>
</body>
</html>